---
layout: post
tags: [python2.7]
categories: blog
---


<!-- vim-markdown-toc GFM -->

  * [捕获 CTRL+C 信号](#捕获-ctrlc-信号)
  * [UnicodeEncodeError](#unicodeencodeerror)
  * [Python 调试](#python-调试)
    * [使用 pdb](#使用-pdb)
* [参考资料](#参考资料)

<!-- vim-markdown-toc -->

### 捕获 CTRL+C 信号
1. 使用 python 的异常`KeyboardInterrupt`:
   ```
   import time, sys
   
   signal.signal(signal.SIGINT, signal.default_int_handler)
   x = 1
   try:
     while True:
       print x
       time.sleep(.3)
       x += 1
   except KeyboardInterrupt:
       print "Bye"
       sys.exit()
   ```
   

2. 使用`signal`模块

    ```
    #!/usr/bin/env python
    import signal
    import sys
    def signal_handler(sig, frame):
            print('You pressed Ctrl+C!')
            sys.exit(0)
    signal.signal(signal.SIGINT, signal_handler)
    print('Press Ctrl+C')
    signal.pause()
    ```
    
详情参考： [How do I capture SIGINT in Python?][capture SIGINT]

[capture SIGINT]:https://stackoverflow.com/questions/1112343/how-do-i-capture-sigint-in-python 

### UnicodeEncodeError
执行代码：
```
def save_html(content):
    with open('a.html', 'w') as f:
        f.write(content)

r=requests.get('https://www.baidu.com')
save_html(r.text)
```
报错：
```python
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "<stdin>", line 3, in save_html
UnicodeEncodeError: 'ascii' codec can't encode characters in position 317-343: ordinal not in range(128)
```
解决办法：
```
def save_html(content):
    with open('a.html', 'w') as f:
        f.write(content.encode('utf8'))

```
详情参考： [UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 20: ordinal not in range(128)][UnicodeEncodeError]

[UnicodeEncodeError]:https://stackoverflow.com/questions/9942594/unicodeencodeerror-ascii-codec-cant-encode-character-u-xa0-in-position-20/38826645 

### Python 调试
详情参考： [IBM-Python 代码调试技巧][pdb-ibm]

[pdb-ibm]:https://www.ibm.com/developerworks/cn/linux/l-cn-pythondebugger/index.html

#### 使用 pdb
在`.bashrc`文件中定义函数`pdb`，方便使用：
```
function pdb(){
	python -m pdb $1
}
```
使用方法：
```
pdb test.py
```

常用命令：

| 命令                | 解释                       |
|---------------------+----------------------------|
| break 或 b 设置断点 | 设置断点                   |
| continue 或 c       | 继续执行程序               |
| list 或 l           | 查看当前行的代码段         |
| step 或 s           | 进入函数                   |
| return 或 r         | 执行代码直到从当前函数返回 |
| exit 或 q           | 中止并退出                 |
| next 或 n           | 执行下一行                 |
| pp                  | 打印变量的值               |
| help                | 帮助                       |

详情参考： [26.2. pdb — The Python Debugger][pdb-offcial]

[pdb-offcial]:https://docs.python.org/2.7/library/pdb.html



## 参考资料
* [How do I capture SIGINT in Python?][capture SIGINT]
* [UnicodeEncodeError: 'ascii' codec can't encode character u'\xa0' in position 20: ordinal not in range(128)][UnicodeEncodeError]

