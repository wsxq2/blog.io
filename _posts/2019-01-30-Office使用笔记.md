---
tags: [Office,PPT,Word,Excel,Note,PDF]
last_modified_time: 2019-11-07 00:31:42 +0800
---

<p id="markdown-toc"></p>
<!-- vim-markdown-toc GFM -->

* [通用](#通用)
  * [重复上一次操作](#重复上一次操作)
* [Word](#word)
  * [组合](#组合)
  * [模板](#模板)
  * [查找和替换](#查找和替换)
  * [题注](#题注)
  * [跳转](#跳转)
  * [粘贴](#粘贴)
  * [将表格内容转换为文本](#将表格内容转换为文本)
  * [表格单元格内的标题不显示在导航窗格中？](#表格单元格内的标题不显示在导航窗格中)
  * [宏](#宏)
    * [简介](#简介)
    * [案例](#案例)
      * [批量转换 docx 为 pdf](#批量转换-docx-为-pdf)
    * [pywin32](#pywin32)
      * [案例](#案例-1)
        * [批量转换 doc 为 pdf](#批量转换-doc-为-pdf)
    * [遇到过的问题](#遇到过的问题)
      * [无法创建宏？](#无法创建宏)
* [PPT](#ppt)
  * [Shortcuts](#shortcuts)
  * [备注](#备注)
  * [提取 PPT 中的所有图片](#提取-ppt-中的所有图片)
* [Excel](#excel)
* [Note](#note)
* [PDF](#pdf)
  * [简介](#简介-1)
  * [PyPDF2](#pypdf2)
    * [案例](#案例-2)
      * [合并多个 PDF 为一个 PDF](#合并多个-pdf-为一个-pdf)
* [链接](#链接)
* [脚注](#脚注)

<!-- vim-markdown-toc -->

本文记录的是 Microsoft Office（主要包括 Word，PPT，Excel，Note）的使用笔记（主要是指遇到的问题及解决办法）

## 通用
这一部分的内容在 Word、PPT、Excel 中均可使用

### 重复上一次操作
使用快捷键`Ctrl+Y`或`F4`即可。详情参见 [撤消、恢复或重复操作 - Office 支持](https://support.office.com/zh-cn/article/%E6%92%A4%E6%B6%88%E3%80%81%E6%81%A2%E5%A4%8D%E6%88%96%E9%87%8D%E5%A4%8D%E6%93%8D%E4%BD%9C-84bdb9bc-4e23-4f06-ba78-f7b893eb2d28)

## Word
### 组合
我有次对图片和多个图形进行组合时，发现“组合”按钮不可用，后来在[组合或取消组合形状、图片或其他对象 - Office 支持](https://support.office.com/zh-cn/article/%E7%BB%84%E5%90%88%E6%88%96%E5%8F%96%E6%B6%88%E7%BB%84%E5%90%88%E5%BD%A2%E7%8A%B6%E3%80%81%E5%9B%BE%E7%89%87%E6%88%96%E5%85%B6%E4%BB%96%E5%AF%B9%E8%B1%A1-a7374c35-20fe-4e0a-9637-7de7d844724b)中的`组合形状、图片或其他对象`一节中找到了答案：

> 请注意, 若要在 Word 中对图片进行分组, "自动换行" 选项必须设置为"嵌入型" 以外的内容

总结：将图片的**环绕文字**选项设置为**嵌入型以外**的内容即可

### 模板
由于感觉在Word中导航非常不方便（才开始用 Word，不知道可以通过标题导航），所以开始学习如何在Word中快速跳转，于是发现了通过标题导航，但是每次都要自己弄样式（默认的有些别扭），而样式修改后又不能永久保存，之前还能将就用，就当作熟悉修改样式的步骤了，后来实在受不了了（当然，还包括其它因素，比如说文档的目录、写实验报告时固定的封面等等）。于是找到了下面这个：

[一劳永逸，打造自己的word常规模板 - 知乎](https://zhuanlan.zhihu.com/p/22737822)

### 查找和替换
由于用习惯了 VIM 中强大的替换功能，起初对于 Word 中的替换功能感到相当不满，直到发现了如下两个链接：
* [Word查找的通配符和特殊字符! - kevinhg的博客 - CSDN博客](https://blog.csdn.net/kevinhg/article/details/7428100)
* [word天，原来“查找”和“替换”这么强大！ - 知乎](https://zhuanlan.zhihu.com/p/26760706)

总之，Word 的查找和替换是非常强大的，可以根据特定的样式进行查找和替换，也可以使用正则表达式（好像是类似于正则表达式的东东）。使用`Ctrl+F`查找，`Ctrl+H`替换

### 题注
在学习 [模板](#模板) 时遇到了**题注**这个东东，而当 word 中有很多图片时，逐个添加题注的标签及编号时效率低下，于是发现了这个：

[批量为word图片添加题注 - 知乎](https://zhuanlan.zhihu.com/p/40692236)

总结：通过复制域代码然后使用替换功能实现的，使用到的快捷键如下：
* `Alt+F9`：显示/关闭域代码。或者右键**题注->切换域代码**
* `Ctrl+C`：复制。或者**右键文本->复制**
* `Ctrl+H`：打开替换窗口。
* `Ctrl+A`：全选。
* `F9`：刷新。（包括各种域代码，超有用）

### 跳转
几乎所有的好一点的文档编辑器都支持跳转到上一个编辑位置（如 VIM 中是`<C-O>`，eclipse 中是`Alt+left`），后来终于也在 word 中找到了相应的快捷键：

[Word文档快速返回目录页和上次编辑点_如水似竹_新浪博客](http://blog.sina.com.cn/s/blog_4bcb70170100r7zh.html)

总结：
`Alt+left`：回到原目录
`Shift+F5`：返回到上次编辑的位置。实际上是在最近的四个位置间循环跳转

### 粘贴
Word 在粘贴时可以控制其格式，甚至可以设置默认粘贴的格式。详情参见：[在粘贴文本时控制其格式 - Word](https://support.office.com/zh-cn/article/%E5%9C%A8%E7%B2%98%E8%B4%B4%E6%96%87%E6%9C%AC%E6%97%B6%E6%8E%A7%E5%88%B6%E5%85%B6%E6%A0%BC%E5%BC%8F-20156a41-520e-48a6-8680-fb9ce15bf3d6#bm4)

### 将表格内容转换为文本
点击**表格工具**-点击**布局**-找到**数据**模块-点击**转换为文本**

### 表格单元格内的标题不显示在导航窗格中？
无解。这是 Word 中的一个已知限制。如果您希望标题显示在导航窗格中，您必须将它们放在表格之外：选中表格中的内容（注意不要选中表格），将它们粘贴到表格之外。详情参见： [表格单元格内的标题不显示在导航窗格中：变通方法？ - VoidCC](http://cn.voidcc.com/question/p-fsvjahvc-dy.html)

### 宏
#### 简介
宏是一系列命令，涉及到编程（脚本语言 Visual Basic）。宏的存在使得 Word 异常强大。

详情参见如下链接：
* [启用或禁用 Office 文件中的宏 - Office 支持](https://support.office.com/zh-cn/article/%E5%90%AF%E7%94%A8%E6%88%96%E7%A6%81%E7%94%A8-office-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%AE%8F-12b036fd-d140-4e74-b45e-16fed1a7e5c6)
* [创建或运行宏 - Word](https://support.office.com/zh-cn/article/%E5%88%9B%E5%BB%BA%E6%88%96%E8%BF%90%E8%A1%8C%E5%AE%8F-c6b99036-905c-49a6-818a-dfb98b7c3c9c)
* [Word批处理——宏 - 简书](https://www.jianshu.com/p/61b88c8607da)

可以使用 VB(Visual Basic) 语言手动编写宏，这时需要用到开发工具（可以直接使用快捷键`Alt+F11`打开）。而 Word 出于安全考虑，默认隐藏了该选项卡，可以在**文件-选项-自定义功能区-主选项卡-开发工具**处打开。此后 Word 上方会多出一个**开发工具**选项卡，在其**代码**版块点击**Visual Basic**即可进入开发工具

在开发工具界面，将焦点放在某个版块后按`F1`可以查看该版块的帮助文档。下面列出几个有用的学习链接：
1. [Visual Basic 用户界面帮助 ｜ Microsoft Docs](https://docs.microsoft.com/zh-cn/office/vba/language/reference/user-interface-help/visual-basic-user-interface-help)
1. [Office VBA 入门 ｜ Microsoft Docs](https://docs.microsoft.com/zh-cn/office/vba/library-reference/concepts/getting-started-with-vba-in-office)
1. [Visual Basic for Applications (VBA) 语言参考 ｜ Microsoft Docs](https://docs.microsoft.com/zh-cn/office/vba/api/overview/language-reference)
1. [Visual Basic 语言参考 ｜ Microsoft Docs](https://docs.microsoft.com/zh-cn/office/vba/language/reference/user-interface-help/visual-basic-language-reference)
1. [Word Visual Basic for Applications (VBA) 参考 ｜ Microsoft Docs](https://docs.microsoft.com/zh-cn/office/vba/api/overview/word)
1. [Visual Basic for Applications (VBA) 库参考 ｜ Microsoft Docs](https://docs.microsoft.com/zh-cn/office/vba/api/overview/library-reference)

#### 案例
##### 批量转换 docx 为 pdf
将某个目录下的所有`docx`文件转换为`pdf`文件（使用 Word 的**另存为**功能）：

<pre>
Option Explicit
Sub docx2other()
On Error Resume Next
Dim sEveryFile As String,sSourcePath As String,sNewSavePath As String
Dim CurDoc As Object
sSourcePath = "E:\DOCX文件\"  
'假定待转换的docx文件全部在"E:\DOCX文件\"下，你需要按实际情况修改。
sEveryFile = Dir(sSourcePath &amp;"*.docx")
Do While sEveryFile &lt;&gt; ""
   Set CurDoc = Documents.Open(sSourcePath &amp; sEveryFile, , , , , , , , , , , msoFalse)
   sNewSavePath = VBA.Strings.Replace(sSourcePath &amp; sEveryFile, ".docx", ".pdf")
   '如果想导出doc/rtf/txt等，就把上一行行尾的pdf换成doc/rtf/txt
   '转化后的文件也在"E:\DOCX文件\"下，当然你可以按需修改。
   CurDoc.SaveAs2 sNewSavePath, wdFormatPDF
   'pdf对应wdFormatPDF,doc对应wdFormatDocument,rtf对应wdFormatRTF,txt对应wdFormatText
   '更多格式可参见文末的截图WdSaveFormat Enumeration
   CurDoc.Close SaveChanges:=False
   sEveryFile= Dir
Loop
Set CurDoc = Nothing
</pre>

以上代码来自 [Word VBA批量格式转换：docx转pdf、doc、rtf、txt以及反向转换 - 磁悬浮青蛙呱呱呱 - CSDN博客](https://blog.csdn.net/pijianzhirui/article/details/78668695)

#### pywin32
pywin32 是 Python 中的用来和 Windows API 交互的库。以下是`pywin32`的官方介绍：

> Python extensions for Microsoft Windows Provides access to much of the Win32 API, the ability to create and use COM objects, and the Pythonwin environment.
> 
> ——引用自 [pywin32 · PyPI](https://pypi.org/project/pywin32/#description)

而 Word 的相关接口也包含在 Win32 API 中，也就是说，你在 Word VBA 中可以使用的所有 API，在这个库中也能使用

具体教程可参见 [Python操作Word入门（Win32com） - 知乎](https://zhuanlan.zhihu.com/p/67543981)

事实上，还有一个和`pywin32`一样提供相同接口的库：`pypiwin32`。这两个库的功能差不多。对于 pywin32 和 pypiwin32 该使用哪一个好的问题，笔者找到两个相反的答案：
1. 认为`pypiwin32`更好：[pywin32 und pypiwin32: what is the difference?](https://mail.python.org/pipermail/python-win32/2016-October/013786.html)
1. 认为`pywin32`更好：[python - What is the difference between pywin32 and pypiwin32? - Stack Overflow](https://stackoverflow.com/a/55918399)

由于`pywin32`最近一次更新是在 2019-09-15 [^pywin32]，新于`pypiwin32`的 2018-02-26[^pypiwin32]，因此我选择使用 pywin32

[^pypiwin32]: https://pypi.org/project/pypiwin32/
[^pywin32]: https://pypi.org/project/pywin32/

##### 案例
###### 批量转换 doc 为 pdf
和前面 VBA 的功能一样，不过用 Python 更方便：
```
# from https://www.bbsmax.com/A/GBJrLR0Zd0/

import win32com.client
import time
import os


def convert_to_pdf():
    # absolute path is needed
    # be careful about the slash '\', use '\\' or '/' or raw string r"..."
    in_dir = r"D:\\docs\\"
    out_dir = in_dir + r"pdf\\"
    wdFormatPDF = 17
    word = win32com.client.Dispatch('Word.Application')
    word.Visible = True
    time.sleep(3)
    first_flag = True

    try:
        for root, dirs, files in os.walk(in_dir):
            for file in files:
                if (file.endswith(".docx") or file.endswith(".doc")) and (not file.startswith('~')):
                    in_file = os.path.join(root, file)
                    out_file_temp = os.path.join(out_dir, file)
                    out_file = out_file_temp.rsplit('.', 1)[0] + '.pdf'
                    # print(in_file)
                    #            print(out_file)
                    # skip existed files
                    if os.path.isfile(out_file):
                        continue
                    print("================================================")
                    print("convert\n'" + in_file + "' into\n" + out_file + "'\n")
                    doc = word.Documents.Open(in_file)
                    doc.SaveAs(out_file, FileFormat=wdFormatPDF)
                    doc.Close()
                    if first_flag:
                        word.Visible = False
                        first_flag = False
    except Exception as inst:
        print(type(inst))  # the exception instance
        print(inst.args)  # arguments stored in .args
        print(inst)  # __str__ allows args to be printed directly,

    word.Quit()
    print("Coversion Done.")

```

#### 遇到过的问题
##### 无法创建宏？
直接删除`C:\Users\<用户名>\AppData\Roaming\Microsoft\Templates\Normal.dotm`文件即可。注意替换其中的`<用户名>`，例如我的是`C:\Users\wsxq2\AppData\Roaming\Microsoft\Templates\Normal.dotm`

参见 [解决Office 365 Word "无法创建宏" - 知乎](https://zhuanlan.zhihu.com/p/56917134)

## PPT
### Shortcuts
官方快捷键列表：[使用键盘快捷方式创建 PowerPoint 演示文稿 - PowerPoint](https://support.office.com/zh-cn/article/%E4%BD%BF%E7%94%A8%E9%94%AE%E7%9B%98%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E5%88%9B%E5%BB%BA-powerpoint-%E6%BC%94%E7%A4%BA%E6%96%87%E7%A8%BF-ebb3d20e-dcd4-444f-a38e-bb5c5ed180f4)

总结（非演示时常用快捷键）：
* `F5`: 从头开始放映幻灯片
* `Shift+F5`: 从当前幻灯片开始放映幻灯片
* `Alt+F5`: 显示演示者视图
* `Ctrl+N`: 新建演示文稿(New)
* `Ctrl+B`: 使所选文字加粗(Bold)
* `Alt+N, P`: 插入图片(Picture)
* `Alt + H、S、H`: 插入形状(SHape)
* `Alt+G, H`: 选择主题(tHeme)
* `Alt+H, L`: 选择幻灯片版式(Layout)
* `Page Down`: 转到下一张幻灯片
* `Page Up`: 转到上一张幻灯片
* `Alt+H`: 转到“开始”选项卡(Home)
* `Alt+N`: 转到“插入”选项卡(iNsert)
* `Ctrl+Shift+Tab`: 在 "缩略图" 窗格和 "大纲视图" 窗格之间切换
* `Alt+Shift+向左键`: 提升段落级别
* `Alt+Shift+向右键`: 降低段落级别
* `Ctrl+Shift+左方括号 ([)`: 将对象置于底层
* `Ctrl+Shift+右方括号 (])`: 将对象置于顶层
* `Ctrl+D 或 Ctrl 并拖动`: 重复对象(Duplicate)
* `Ctrl+Enter`: 移到下一个标题或正文文本占位符。如果是幻灯片上的最后一个占位符, 此操作将插入与原始幻灯片具有相同幻灯片版式的新幻灯片
* `Shift+F4`: 移动以重复上一个"查找"操作

在演示过程中, 若要查看快捷方式列表, 请按`F1`。

### 备注
PPT演示中，**演示者视图**非常有用，其右下角的**备注**引起了我的注意（这个用好了就可以实现“脱稿”演示），于是想知道如何添加备注，找到答案如下：

[向幻灯片添加演讲者备注 - Office 支持](https://support.office.com/zh-cn/article/%E5%90%91%E5%B9%BB%E7%81%AF%E7%89%87%E6%B7%BB%E5%8A%A0%E6%BC%94%E8%AE%B2%E8%80%85%E5%A4%87%E6%B3%A8-26985155-35f5-45ba-812b-e1bd3c48928e)

总结：在 PPT 的状态栏（在最下面）中即有**备注**和**批注**

### 提取 PPT 中的所有图片
ppt本身是个 zip 格式的压缩文件，所以可以使用解压软件打开它，它所有的图片通常在`ppt\media`目录下。直接解压后复制里面的内容到你需要的地方就可以了
## Excel

## Note

## PDF
严格来说，PDF 不属于 Office。但是由于其和 Office 联系密切（尤其是其中的 Word），于是就放到这里了。

首先，让我们来认识一下 PDF

### 简介
> 便携式文档格式（英语：Portable Document Format，缩写：PDF）是一种用独立于应用程序、硬件、操作系统的方式呈现文档的文件格式。[2]每个PDF文件包含固定布局的平面文档的完整描述，包括文本、字形、图形及其他需要显示的信息。1991年，Adobe Systems共同创始人约翰·沃诺克提出的名为“Camelot”的系统[3]演变成PDF。 如今，PDF文件除平面的文本和图形外，还可能包括逻辑结构元素，注释、表单、图层、富媒体（包括视频内容）之类的交互元素，使用U3D或PRC的三维对象，以及多种其他数据内容。PDF规范还提供了启用这些功能时所需的加密功能、数字签名、文档附件和元数据等。
> 
> ——引用自 [便携式文档格式 - 维基百科，自由的百科全书](https://zh.wikipedia.org/wiki/%E5%8F%AF%E7%A7%BB%E6%A4%8D%E6%96%87%E6%A1%A3%E6%A0%BC%E5%BC%8F)

总之，PDF 是一个在任何打印店都能打出预想中的格式的文件格式。Word 格式则不一定，有的 Word 处理程序（如 WPS）和官方的 Word 不兼容，可能会导致打印出的格式出人意料

### PyPDF2
PyPDF2 是 Python 中用于处理 PDF 文档的库，它可以实现不少需要使用 Adobe Acrobat Pro（这是一个付费软件，而且费用还不低且占用空间大[^acrobat]）才能实现的功能

其实除了知名的 PyPDF2 之外，还有 PyPDF3 和 PyPDF4，至于它们的区别，就暂时不做研究了

[^acrobat]: https://acrobat.adobe.com/cn/zh-Hans/acrobat/pdf-reader.html）

#### 案例
##### 合并多个 PDF 为一个 PDF
以下代码将`in_dir`目录下的所有 PDF 合并为一个 PDF，并输出到`out_dir`：
```
# from https://stackoverflow.com/a/47356404
import os
from PyPDF2 import PdfFileMerger

def mergePDF(in_dir, out_dir):
    os.chdir(in_dir)
    x = [a for a in os.listdir() if a.endswith(".pdf")]
    print(x)

    merger = PdfFileMerger()

    for pdf in x:
        merger.append(open(pdf, 'rb'))

    with open(out_dir+r"result.pdf", "wb") as fout:
        merger.write(fout)
```
上述代码来自 [python - Merge PDF files - Stack Overflow](https://stackoverflow.com/questions/3444645/merge-pdf-files/47356404#47356404)

在执行上述代码中，遇到了如下错误：
```
UnicodeEncodeError: 'latin-1' codec can't encode characters in position 8-9: ordinal not in range(256)

```
解决方法为：将`utils.py`中的 238-241 行：
```
r = s.encode('latin-1')
if len(s) < 2:
    bc[s] = r
return r
```

替换为：
```
try:
    r = s.encode('latin-1')
except:
    r = s.encode('utf-8')
if len(s) < 2:
    bc[s] = r
return r
```

详情参见 [编码问题: PyPDF2.utils.PdfReadError: Illegal character in Name Object · Issue #438 · mstamy2/PyPDF2](https://github.com/mstamy2/PyPDF2/issues/438)

相关问题：[利用python处理pdf：奇数页pdf末尾添加一个空白页 - 知乎](https://zhuanlan.zhihu.com/p/34246341)


## 链接
下面总结了本文中使用的所有链接：

<!-- link start -->
* [向幻灯片添加演讲者备注 - Office 支持](https://support.office.com/zh-cn/article/%E5%90%91%E5%B9%BB%E7%81%AF%E7%89%87%E6%B7%BB%E5%8A%A0%E6%BC%94%E8%AE%B2%E8%80%85%E5%A4%87%E6%B3%A8-26985155-35f5-45ba-812b-e1bd3c48928e)
* [使用键盘快捷方式创建 PowerPoint 演示文稿 - PowerPoint](https://support.office.com/zh-cn/article/%E4%BD%BF%E7%94%A8%E9%94%AE%E7%9B%98%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F%E5%88%9B%E5%BB%BA-powerpoint-%E6%BC%94%E7%A4%BA%E6%96%87%E7%A8%BF-ebb3d20e-dcd4-444f-a38e-bb5c5ed180f4)
* [Word文档快速返回目录页和上次编辑点_如水似竹_新浪博客](http://blog.sina.com.cn/s/blog_4bcb70170100r7zh.html)
* [批量为word图片添加题注 - 知乎](https://zhuanlan.zhihu.com/p/40692236)
* [word天，原来“查找”和“替换”这么强大！ - 知乎](https://zhuanlan.zhihu.com/p/26760706)
* [Word查找的通配符和特殊字符! - kevinhg的博客 - CSDN博客](https://blog.csdn.net/kevinhg/article/details/7428100)
* [一劳永逸，打造自己的word常规模板 - 知乎](https://zhuanlan.zhihu.com/p/22737822)
* [组合或取消组合形状、图片或其他对象 - Office 支持](https://support.office.com/zh-cn/article/%E7%BB%84%E5%90%88%E6%88%96%E5%8F%96%E6%B6%88%E7%BB%84%E5%90%88%E5%BD%A2%E7%8A%B6%E3%80%81%E5%9B%BE%E7%89%87%E6%88%96%E5%85%B6%E4%BB%96%E5%AF%B9%E8%B1%A1-a7374c35-20fe-4e0a-9637-7de7d844724b)

<!-- link end -->

<!-- abbreviations start -->

<!-- abbreviations end -->

## 脚注
